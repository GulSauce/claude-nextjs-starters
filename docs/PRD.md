# 퀴즈 프롬프트 검증기 MVP PRD

## 핵심 정보

**목적**: AI에게 문서 기반 퀴즈 생성을 요청할 때 사용하는 메타프롬프트의 품질을 로컬에서 자동 평가하여 점수와 구체적 개선안을 제공함으로써 퀴즈 생성 품질을 향상시킨다.

**사용자**: 문서를 기반으로 퀴즈를 생성하는 AI 프롬프트를 작성하고 품질을 개선하고 싶은 1인 개발자 또는 콘텐츠 제작자

---

## 사용자 여정

```
1. 메인 페이지 (검증하기)
   - 대상 AI 모델 선택 (gpt-4.1 / gemini-3-flash / claude-sonnet-4)
   - 메타프롬프트 입력 (Textarea)
   ↓ "검증 요청 제출" 버튼 클릭

2. [API] POST /api/prompts 호출
   - 입력값 zod 검증
   - ID 생성 후 data/prompts/{id}.json 저장 (status: "pending")
   ↓ 성공 시 /results/{id} 로 자동 이동
   + 토스트 알림: "터미널에서 /validate 커맨드를 실행하세요"

3. 결과 페이지 (/results/{id}) - 대기 상태
   - data/results/{id}.json 파일 없음 → 대기 안내 메시지 표시
   - "아직 검증이 완료되지 않았습니다. Claude Code 터미널에서 /validate를 실행하세요."
   ↓ 사용자가 터미널에서 /validate 실행

4. [Claude Code] /validate 커맨드 실행
   - data/prompts/ 디렉토리에서 status: "pending" 파일 탐색
   - 6개 루브릭 기준으로 각 항목 평가 및 점수 산정
   - 모델별 최적화 가이드 적용
   - data/results/{id}.json 생성 (검증 결과 저장)
   - 원본 프롬프트 파일 status → "validated" 업데이트
   ↓ 완료 후 사용자가 브라우저 새로고침

5. 결과 페이지 (/results/{id}) - 검증 완료 상태
   - 총점 (0~100) + 등급 뱃지 (A/B/C/D/F) 표시
   - 항목별 루브릭 점수 카드 (7개 항목)
   - 탭 전환: 항목별 점수 / 개선된 프롬프트 / 원본 프롬프트
   ↓ "히스토리" 메뉴 이동 가능

6. 히스토리 페이지 (/history)
   - 이전 검증 결과 카드 목록 (모델명, 총점, 프롬프트 미리보기, 일시)
   ↓ 카드 클릭 시 /results/{id} 이동
```

---

## 기능 명세

### 1. MVP 핵심 기능

| ID       | 기능명                    | 설명                                                                                            | MVP 필수 이유                                                       | 관련 페이지                       |
| -------- | ------------------------- | ----------------------------------------------------------------------------------------------- | ------------------------------------------------------------------- | --------------------------------- |
| **F001** | 메타프롬프트 입력 및 제출 | 대상 모델 선택 + 메타프롬프트 텍스트 입력 후 JSON 파일로 저장                                   | 검증 파이프라인의 시작점. 없으면 도구 자체가 동작 불가              | 메인 페이지                       |
| **F002** | 루브릭 기반 자동 평가     | Claude Code /validate 커맨드가 7개 항목(총 100점) 기준으로 프롬프트 품질 평가 및 결과 파일 저장 | 도구의 핵심 가치. 품질 수치화 없이는 검증 도구로 기능하지 않음      | Claude Code (터미널)              |
| **F003** | 결과 상세 확인            | 총점, 등급, 항목별 점수/피드백, 개선된 프롬프트를 탭 UI로 표시                                  | 검증 결과를 사용자가 확인하고 프롬프트를 개선하는 핵심 단계         | 결과 상세 페이지                  |
| **F004** | 검증 이력 조회            | 이전 검증 결과 목록을 카드 형태로 표시, 상세 페이지로 이동                                      | 반복 개선 시 과거 결과와 비교할 수 있어야 도구의 실용성이 높아짐    | 히스토리 페이지                   |
| **F005** | 등급 산정                 | 총점 기준 A(90+)/B(80+)/C(70+)/D(60+)/F(60 미만) 등급 자동 계산 및 색상 뱃지 표시               | 점수를 직관적으로 파악할 수 있는 시각적 표현. 결과 가독성 필수 요소 | 결과 상세 페이지, 히스토리 페이지 |

### 2. MVP 필수 지원 기능

| ID       | 기능명              | 설명                                                                          | MVP 필수 이유                                                  | 관련 페이지                                    |
| -------- | ------------------- | ----------------------------------------------------------------------------- | -------------------------------------------------------------- | ---------------------------------------------- |
| **F010** | 로컬 JSON 파일 저장 | 프롬프트 입력 및 검증 결과를 data/ 디렉토리의 JSON 파일로 저장/읽기           | 외부 DB 없이 로컬 도구로 동작하기 위한 유일한 데이터 저장 방법 | 메인 페이지, 결과 상세 페이지, 히스토리 페이지 |
| **F011** | 입력값 유효성 검사  | zod 스키마로 대상 모델 선택 여부 및 프롬프트 최소 길이 검증, 에러 메시지 표시 | 잘못된 입력이 파일 저장까지 도달하지 않도록 방지               | 메인 페이지                                    |
| **F012** | 검증 대기 상태 안내 | 결과 파일이 없을 때 /validate 실행 안내 메시지와 함께 대기 상태 표시          | 검증 전 결과 페이지 접근 시 사용자에게 다음 행동 명확히 안내   | 결과 상세 페이지                               |

### 3. MVP 이후 기능 (제외)

- 실시간 자동 폴링 (결과 파일 생성 감지 후 자동 갱신)
- 커스텀 루브릭 편집 UI
- 프롬프트 버전 비교 기능
- 검증 결과 내보내기 (CSV, PDF)
- 다크/라이트 테마 토글 (이미 기본 구성됨)
- 알림 시스템

---

## 메뉴 구조

```
퀴즈 프롬프트 검증기 내비게이션
├── 검증하기 (메인)
│   └── 기능: F001 (메타프롬프트 입력 및 제출), F011 (입력값 유효성 검사)
└── 히스토리
    └── 기능: F004 (검증 이력 조회), F005 (등급 뱃지)

결과 페이지 (메뉴 없음, 제출 후 자동 이동)
└── 기능: F003 (결과 상세 확인), F005 (등급 산정), F012 (검증 대기 상태 안내)

공통 (모든 페이지)
└── 기능: F010 (로컬 JSON 파일 저장/읽기 - 서버사이드)
```

---

## 페이지별 상세 기능

### 메인 페이지 (검증하기)

> **구현 기능:** `F001`, `F011`, `F010` | **메뉴 위치:** 헤더 최상단 "검증하기"

| 항목            | 내용                                                                                                                                                                                                                                                                                                                                |
| --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **역할**        | 메타프롬프트 입력 폼 페이지. 사용자가 평가받을 프롬프트를 제출하여 검증 파이프라인을 시작하는 진입점                                                                                                                                                                                                                                |
| **진입 경로**   | 헤더 "검증하기" 메뉴 클릭 또는 루트 URL(/) 직접 접근                                                                                                                                                                                                                                                                                |
| **사용자 행동** | 대상 AI 모델을 드롭다운에서 선택하고, 검증받을 메타프롬프트를 텍스트 영역에 입력한 뒤 제출 버튼을 클릭함                                                                                                                                                                                                                            |
| **주요 기능**   | - 대상 모델 Select (gpt-4.1 / gemini-3-flash / claude-sonnet-4 세 가지 옵션)<br>- 메타프롬프트 Textarea (최소 10줄 높이, 최소 길이 유효성 검사)<br>- zod 스키마 기반 실시간 에러 메시지 표시<br>- **"검증 요청 제출" 버튼** 클릭 시 POST /api/prompts 호출<br>- 성공 시 sonner 토스트 알림 "터미널에서 /validate를 실행하세요" 표시 |
| **다음 이동**   | 제출 성공 → /results/{id} 자동 이동, 제출 실패 → 폼에 에러 메시지 표시 후 유지                                                                                                                                                                                                                                                      |

---

### 결과 상세 페이지

> **구현 기능:** `F003`, `F005`, `F012`, `F010` | **메뉴 위치:** 메뉴 없음 (폼 제출 후 자동 이동 또는 히스토리에서 클릭)

| 항목            | 내용                                                                                                                                                                                                                                                                                                                                                                                                |
| --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **역할**        | 특정 프롬프트의 검증 결과를 표시하는 상세 페이지. 대기 중일 때는 안내 메시지, 완료 시에는 점수/피드백/개선안을 표시                                                                                                                                                                                                                                                                                 |
| **진입 경로**   | 메인 페이지 폼 제출 성공 시 자동 리디렉션, 또는 히스토리 페이지의 카드 클릭                                                                                                                                                                                                                                                                                                                         |
| **사용자 행동** | 검증 결과가 없으면 터미널에서 /validate를 실행하고 페이지를 새로고침함. 결과가 있으면 탭을 전환하며 점수, 피드백, 개선된 프롬프트를 확인함                                                                                                                                                                                                                                                          |
| **주요 기능**   | - **대기 상태**: data/results/{id}.json 없을 때 안내 메시지 + /validate 실행 안내 표시 (F012)<br>- **완료 상태**: 총점(0~100) + 등급 뱃지(A~F, 색상 구분) 표시 (F005)<br>- 탭 1 "항목별 점수": 6개 루브릭 항목 점수 카드 (항목명, 점수/배점, 피드백, 개선 제안)<br>- 탭 2 "개선된 프롬프트": Claude Code가 생성한 개선 프롬프트 텍스트<br>- 탭 3 "원본 프롬프트": 제출했던 원본 메타프롬프트 텍스트 |
| **다음 이동**   | 헤더 "히스토리" 클릭 → 히스토리 페이지, 헤더 "검증하기" 클릭 → 메인 페이지                                                                                                                                                                                                                                                                                                                          |

---

### 히스토리 페이지

> **구현 기능:** `F004`, `F005`, `F010` | **메뉴 위치:** 헤더 "히스토리"

| 항목            | 내용                                                                                                                                                                                                                                                                 |
| --------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **역할**        | 이전 검증 결과 목록을 카드 형태로 나열하는 페이지. 반복 개선 시 과거 결과와 비교하는 기준점 역할                                                                                                                                                                     |
| **진입 경로**   | 헤더 "히스토리" 메뉴 클릭                                                                                                                                                                                                                                            |
| **사용자 행동** | 카드 목록에서 이전 검증 결과를 훑어보고, 상세 확인이 필요한 카드를 클릭하여 결과 상세 페이지로 이동함                                                                                                                                                                |
| **주요 기능**   | - data/results/ 디렉토리 스캔하여 전체 결과 파일 목록 로드<br>- 각 결과를 카드로 표시: 대상 모델명, 총점, 등급 뱃지(F005), 프롬프트 미리보기(앞 100자), 검증 일시<br>- 결과 없을 때 빈 상태 안내 메시지 표시<br>- **카드 전체 클릭** 시 해당 결과 상세 페이지로 이동 |
| **다음 이동**   | 카드 클릭 → /results/{id} 이동                                                                                                                                                                                                                                       |

---

## 데이터 모델

### PromptInput (프롬프트 입력 — data/prompts/{id}.json)

| 필드        | 설명                        | 타입/관계                                          |
| ----------- | --------------------------- | -------------------------------------------------- |
| id          | 고유 식별자                 | UUID                                               |
| targetModel | 대상 AI 모델                | "gpt-4.1" \| "gemini-3-flash" \| "claude-sonnet-4" |
| promptText  | 검증 대상 메타프롬프트 전문 | string                                             |
| createdAt   | 제출 일시                   | ISO 8601 string                                    |
| status      | 검증 상태                   | "pending" \| "validated"                           |

### ValidationResult (검증 결과 — data/results/{id}.json)

| 필드            | 설명                    | 타입/관계                       |
| --------------- | ----------------------- | ------------------------------- |
| id              | 프롬프트 ID와 동일      | UUID (→ PromptInput.id)         |
| promptId        | 연결된 프롬프트 ID      | → PromptInput.id                |
| targetModel     | 평가에 사용된 대상 모델 | string                          |
| totalScore      | 총점 (0~100)            | number                          |
| grade           | 등급                    | "A" \| "B" \| "C" \| "D" \| "F" |
| rubricScores    | 항목별 점수 배열        | RubricScore[]                   |
| overallFeedback | 전체 종합 피드백        | string                          |
| improvedPrompt  | 개선된 메타프롬프트     | string                          |
| validatedAt     | 검증 완료 일시          | ISO 8601 string                 |

### RubricScore (루브릭 항목 점수 — ValidationResult.rubricScores 내 배열 요소)

| 필드          | 설명             | 타입/관계                                                                                                             |
| ------------- | ---------------- | --------------------------------------------------------------------------------------------------------------------- |
| criterionId   | 루브릭 항목 ID   | "clarity" \| "document_grounding" \| "difficulty_control" \| "answer_quality" \| "edge_cases" \| "model_optimization" |
| criterionName | 항목 한국어 이름 | string                                                                                                                |
| score         | 획득 점수        | number                                                                                                                |
| maxScore      | 항목 배점        | number                                                                                                                |
| feedback      | 항목별 피드백    | string                                                                                                                |
| suggestion    | 구체적 개선 제안 | string                                                                                                                |

---

## 루브릭 기준 (6개 항목, 100점 만점)

> 구조화된 출력 형식(JSON 스키마 등)은 시스템 프롬프트에서 개발자가 별도로 지정하므로 평가 대상에서 제외.

| ID                 | 항목명            | 배점 | 평가 기준                                                                 |
| ------------------ | ----------------- | ---- | ------------------------------------------------------------------------- |
| clarity            | 명확성과 구체성   | 25점 | 퀴즈 유형, 난이도, 문항 수 등이 구체적으로 명시되었는가                   |
| document_grounding | 문서 기반 지시    | 20점 | "제공된 문서 내용만으로" 퀴즈를 생성하라는 명시적 지시가 있는가           |
| difficulty_control | 난이도 제어       | 15점 | 난이도 단계 정의, 블룸 택소노미 등 교육학적 프레임워크 활용 여부          |
| answer_quality     | 정답 및 해설 품질 | 20점 | 정답, 오답 선지, 해설 생성에 대한 명확한 지시 여부                        |
| edge_cases         | 예외 처리         | 10점 | 문서 내용 부족 시 처리 방법, 모호한 문제 회피 등 예외 상황 대응 지시 여부 |
| model_optimization | 모델 최적화       | 10점 | 대상 모델 특성에 맞는 프롬프트 패턴 사용 여부                             |

**등급 기준**: A (90점 이상), B (80점 이상), C (70점 이상), D (60점 이상), F (60점 미만)

**모델별 최적화 가이드**:

- GPT 계열: system/user 역할 분리, JSON 모드 활용 권장
- Gemini 계열: 문서를 프롬프트 앞에 배치, 명시적 섹션 구분
- Claude 계열: XML 태그 활용, 예시 포함 권장

---

## 파일 변경 목록

### 새로 생성 (16개)

| 파일                                   | 용도                                                                  |
| -------------------------------------- | --------------------------------------------------------------------- |
| `lib/types.ts`                         | TargetModel, PromptInput, ValidationResult, RubricScore 타입 정의     |
| `lib/rubrics.ts`                       | 6개 루브릭 기준 + 모델별 최적화 가이드 + 등급 계산 함수               |
| `lib/data.ts`                          | 파일시스템 기반 데이터 유틸리티 (savePrompt, getPrompt, getResult 등) |
| `app/api/prompts/route.ts`             | POST: 프롬프트 입력 저장 API                                          |
| `app/api/results/[id]/route.ts`        | GET: 결과 조회 API                                                    |
| `app/api/prompts/[id]/status/route.ts` | GET: 프롬프트 상태 폴링 API                                           |
| `app/results/[id]/page.tsx`            | 결과 상세 페이지 (서버 컴포넌트)                                      |
| `app/history/page.tsx`                 | 히스토리 목록 페이지 (서버 컴포넌트)                                  |
| `components/prompt-validator-form.tsx` | 메타프롬프트 입력 폼 (클라이언트 컴포넌트)                            |
| `components/validation-result.tsx`     | 검증 결과 탭 UI (항목별 점수 / 개선 프롬프트 / 원본)                  |
| `components/rubric-score-card.tsx`     | 루브릭 항목별 점수 카드                                               |
| `components/score-badge.tsx`           | 등급별 색상 뱃지 (A=초록, B=파랑, C=노랑, D=주황, F=빨강)             |
| `components/history-card.tsx`          | 히스토리 목록 아이템 카드                                             |
| `.claude/commands/validate.md`         | /validate 슬래시 커맨드 정의                                          |
| `data/prompts/.gitkeep`                | prompts 디렉토리 유지                                                 |
| `data/results/.gitkeep`                | results 디렉토리 유지                                                 |

### 수정 (8개)

| 파일                           | 변경 내용                                                               |
| ------------------------------ | ----------------------------------------------------------------------- |
| `app/page.tsx`                 | PromptValidatorForm 컴포넌트 렌더링으로 전면 교체                       |
| `app/layout.tsx`               | metadata 변경 (title: "퀴즈 프롬프트 검증기")                           |
| `lib/nav-items.ts`             | [{href: "/", label: "검증하기"}, {href: "/history", label: "히스토리"}] |
| `lib/site-config.ts`           | 사이트명 및 GitHub URL 변경                                             |
| `components/layout/header.tsx` | 로고 텍스트 변경, 로그인 버튼 제거                                      |
| `components/layout/footer.tsx` | 프로젝트에 맞게 텍스트 수정                                             |
| `CLAUDE.md`                    | 검증 시스템 데이터 플로우 및 /validate 커맨드 사용법 추가               |
| `.gitignore`                   | data/prompts/_.json, data/results/_.json 추가                           |

### 삭제 (2개)

| 파일                        | 삭제 이유                   |
| --------------------------- | --------------------------- |
| `app/login/page.tsx`        | 로컬 도구이므로 인증 불필요 |
| `components/login-form.tsx` | 로그인 폼 불필요            |

---

## 검증 방법

1. `npm run dev` 로 개발 서버 실행
2. 메인 페이지에서 모델 선택 + 메타프롬프트 입력 후 제출
3. `data/prompts/` 디렉토리에 JSON 파일 생성 확인
4. Claude Code 터미널에서 `/validate` 실행
5. `data/results/` 디렉토리에 결과 JSON 생성 확인
6. 웹 UI 결과 페이지에서 점수, 피드백, 개선 프롬프트 확인
7. 히스토리 페이지에서 이전 결과 목록 확인
8. `npm run build` 로 빌드 에러 없는지 확인
